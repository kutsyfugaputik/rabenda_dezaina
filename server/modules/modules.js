const sequelize = require('../modules/db'); // –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Sequelize
const logAction = require('../utils/logger'); // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

// –ò–º–ø–æ—Ä—Ç –º–æ–¥–µ–ª–µ–π —Ç–∞–±–ª–∏—Ü
const ServiceTypes = require('../modules/tables/serv_types');
const Users = require('../modules/tables/users');
const Clients = require('../modules/tables/clients');
const Masters = require('../modules/tables/masters');
const Services = require('../modules/tables/services');
const Discounts = require('../modules/tables/discount');
const Statuses = require('../modules/tables/statuses');
const Feedback = require('../modules/tables/feedback');
const Requests = require('../modules/tables/reqs');

// üëâ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏
const defineAssociations = () => {
  logAction('–ó–∞–ø—É—Å–∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–π –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏...', 'üîó'); // –õ–æ–≥–∏—Ä—É–µ–º –Ω–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–π

  // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
  logAction('–û–ø—Ä–µ–¥–µ–ª—è–µ–º –∞—Å—Å–æ—Ü–∏–∞—Ü–∏—é: Users.hasOne(Clients)', 'üîó'); // –õ–æ–≥–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏ Users –∏ Clients
  Users.hasOne(Clients, { foreignKey: 'user_id' });
  Clients.belongsTo(Users, { foreignKey: 'user_id' }); // –ö–ª–∏–µ–Ω—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
  logAction('–ê—Å—Å–æ—Ü–∏–∞—Ü–∏—è Users –∏ Clients –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ.', '‚úÖ'); // –õ–æ–≥–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏

  // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å –º–∞—Å—Ç–µ—Ä–æ–º, –Ω–æ –æ–¥–∏–Ω –º–∞—Å—Ç–µ—Ä –ø—Ä–∏–≤—è–∑–∞–Ω —Ç–æ–ª—å–∫–æ –∫ –æ–¥–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
  logAction('–û–ø—Ä–µ–¥–µ–ª—è–µ–º –∞—Å—Å–æ—Ü–∏–∞—Ü–∏—é: Users.hasOne(Masters)', 'üîó'); // –õ–æ–≥–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏ Users –∏ Masters
  Users.hasOne(Masters, { foreignKey: 'user_id' });
  Masters.belongsTo(Users, { foreignKey: 'user_id' }); // –ú–∞—Å—Ç–µ—Ä –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
  logAction('–ê—Å—Å–æ—Ü–∏–∞—Ü–∏—è Users –∏ Masters –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ.', '‚úÖ'); // –õ–æ–≥–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏

  // –ú–∞—Å—Ç–µ—Ä –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ —É—Å–ª—É–≥
  logAction('–û–ø—Ä–µ–¥–µ–ª—è–µ–º –∞—Å—Å–æ—Ü–∏–∞—Ü–∏—é: Masters.hasMany(Services)', 'üîó'); // –õ–æ–≥–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏ Masters –∏ Services
  Masters.hasMany(Services, { foreignKey: 'master_id' });
  Services.belongsTo(Masters, { foreignKey: 'master_id' }); // –£—Å–ª—É–≥–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –º–∞—Å—Ç–µ—Ä—É
  logAction('–ê—Å—Å–æ—Ü–∏–∞—Ü–∏—è Masters –∏ Services –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ.', '‚úÖ'); // –õ–æ–≥–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏

  // –£—Å–ª—É–≥–∞ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ —Ç–∏–ø—É —É—Å–ª—É–≥–∏
  logAction('–û–ø—Ä–µ–¥–µ–ª—è–µ–º –∞—Å—Å–æ—Ü–∏–∞—Ü–∏—é: Services.belongsTo(ServiceTypes)', 'üîó'); // –õ–æ–≥–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏ Services –∏ ServiceTypes
  Services.belongsTo(ServiceTypes, { foreignKey: 'service_type_id' });
  logAction('–ê—Å—Å–æ—Ü–∏–∞—Ü–∏—è Services –∏ ServiceTypes –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ.', '‚úÖ'); // –õ–æ–≥–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏

  // –ó–∞–∫–∞–∑ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å—É—â–Ω–æ—Å—Ç—è–º–∏ (–æ—Ç–∑—ã–≤—ã, —Å–∫–∏–¥–∫–∏, —É—Å–ª—É–≥–∏, —Å—Ç–∞—Ç—É—Å—ã, –∫–ª–∏–µ–Ω—Ç—ã)
  logAction('–û–ø—Ä–µ–¥–µ–ª—è–µ–º –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏ –¥–ª—è Requests...', 'üîó'); // –õ–æ–≥–∏—Ä—É–µ–º –Ω–∞—á–∞–ª–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–π –¥–ª—è Requests
  Requests.belongsTo(Feedback, { foreignKey: 'feedback_id' });
  Requests.belongsTo(Discounts, { foreignKey: 'discount_id' });
  Requests.belongsTo(Services, { foreignKey: 'service_id' });
  Requests.belongsTo(Statuses, { foreignKey: 'status_id' });
  Requests.belongsTo(Clients, { foreignKey: 'client_id' });
  logAction('–ê—Å—Å–æ—Ü–∏–∞—Ü–∏–∏ –¥–ª—è Requests –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ.', '‚úÖ'); // –õ–æ–≥–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–π

  // –°—Ç–∞—Ç—É—Å—ã –º–æ–≥—É—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω—ã —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –∑–∞–∫–∞–∑–æ–≤
  logAction('–û–ø—Ä–µ–¥–µ–ª—è–µ–º –∞—Å—Å–æ—Ü–∏–∞—Ü–∏—é: Statuses.hasMany(Requests)', 'üîó'); // –õ–æ–≥–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏ Statuses –∏ Requests
  Statuses.hasMany(Requests, { foreignKey: 'status_id' });
  logAction('–ê—Å—Å–æ—Ü–∏–∞—Ü–∏—è Statuses –∏ Requests –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ.', '‚úÖ'); // –õ–æ–≥–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏

  // –û—Ç–∑—ã–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω —Å –æ–¥–Ω–∏–º –∑–∞–∫–∞–∑–æ–º
  logAction('–û–ø—Ä–µ–¥–µ–ª—è–µ–º –∞—Å—Å–æ—Ü–∏–∞—Ü–∏—é: Feedback.hasOne(Requests)', 'üîó'); // –õ–æ–≥–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏ Feedback –∏ Requests
  Feedback.hasOne(Requests, { foreignKey: 'feedback_id' });
  logAction('–ê—Å—Å–æ—Ü–∏–∞—Ü–∏—è Feedback –∏ Requests –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ.', '‚úÖ'); // –õ–æ–≥–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏
};

// –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏
logAction('–ó–∞–ø—É—Å–∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–π –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏...', 'üîó'); // –õ–æ–≥–∏—Ä—É–µ–º –Ω–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
defineAssociations(); // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–π
logAction('–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ.', '‚úÖ'); // –õ–æ–≥–∏—Ä—É–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–π

// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
logAction('–õ–æ–≥–∏—Ä—É–µ–º –º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:', 'üìù'); // –õ–æ–≥–∏—Ä—É–µ–º –Ω–∞—á–∞–ª–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π
console.log({ 
  Users,
  Clients,
  Masters,
  Services,
  Discounts, 
  Requests,
  Statuses,
  Feedback,
  ServiceTypes 
}); // –í—ã–≤–æ–¥–∏–º –≤—Å–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

// ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º —É–∂–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
module.exports = {
  Users,
  Clients,
  Masters,
  Services,
  Discounts, 
  Requests,
  Statuses,
  Feedback,
  ServiceTypes,
};
